Notebook[{

Cell[CellGroupData[{
Cell["Verify RBC Calculations", "Title",
 TextAlignment->Center],

Cell[CellGroupData[{

Cell["Initialization", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{
    RowBox[{"InputNotebook", "[", "]"}], ",", 
    RowBox[{"PrivateNotebookOptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<FileOutlineCache\>\"", "\[Rule]", "False"}], "}"}]}], ",", 
    RowBox[{"TrackCellChangeTimes", "\[Rule]", "False"}]}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"use", " ", "Cell"}], "\[Rule]", 
    RowBox[{"Delete", " ", "All", " ", "Output"}]}], "*)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Switch", "[", 
   RowBox[{
   "$System", ",", "\[IndentingNewLine]", "\"\<Mac OS X x86 (64-bit)\>\"", 
    ",", 
    RowBox[{
    "SetDirectory", "[", 
     "\"\</Users/garyanderson/git/ProjectionMethodTools/\
ProjectionMethodToolsJava/code\>\"", "]"}], ",", "\[IndentingNewLine]", 
    "\"\<Linux x86 (64-bit)\>\"", ",", 
    RowBox[{
    "SetDirectory", "[", 
     "\"\<~/git/ProjectionMethodTools/ProjectionMethodToolsJava/code\>\"", 
     "]"}], ",", "\[IndentingNewLine]", "\"\<Microsoft Windows (64-bit)\>\"", 
    ",", 
    RowBox[{
    "SetDirectory", "[", 
     "\"\<g:/git/ProjectionMethodTools/ProjectionMethodToolsJava/code\>\"", 
     "]"}]}], "]"}], ";", 
  RowBox[{"Needs", "[", "\"\<simpleRBCModel`\>\"", "]"}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrices and Equations for Paper", "Section"],

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<AMAPaperCalcs.mth\>\"", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<demoApprox.mth\>\"", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<paperCalcsRBCExample.mth\>\"", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"xtExt00", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Private`computeNextXt", "[", 
         RowBox[{"{", 
          RowBox[{
          "Private`bmatExt", ",", "Private`phimatExt", ",", "Private`fmatExt",
            ",", "Private`psiepsExt", ",", "Private`psicExt", ",", 
           "Private`psizExt"}], "}"}], "]"}], "//", "N"}], "//", "Expand"}], "//",
       "Simplify"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"zName_", "[", "t", "]"}], "\[Rule]", "zName"}], "}"}]}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"xtp1Ext00", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Private`computeNextXtp1", "[", 
          RowBox[{"{", 
           RowBox[{
           "Private`bmatExt", ",", "Private`phimatExt", ",", 
            "Private`fmatExt", ",", "Private`psiepsExt", ",", 
            "Private`psicExt", ",", "Private`psizExt"}], "}"}], "]"}], "//", 
         "N"}], "//", "Expand"}], "//", "Simplify"}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"zName_", "[", "t", "]"}], "\[Rule]", "zName"}], "}"}]}]}], 
   ";"}], "\n"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"someLatexSubs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"epsVar$1", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"epsilon", ",", "t"}], "]"}]}], ",", 
     RowBox[{"xxxtm1Var$2", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"k", ",", 
        RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{"xxxtm1Var$4", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"theta", ",", 
        RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{"zzz$0$1", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"z1", ",", 
        RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{"zzz$0$2", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"z2", ",", 
        RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{"zzz$0$3", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"z3", ",", 
        RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{"zzz$0$4", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"z4", ",", 
        RowBox[{"t", "-", "1"}]}], "]"}]}]}], "}"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TeXForm", "[", 
   RowBox[{"xtExt00", "/.", "someLatexSubs"}], "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TeXForm", "[", 
   RowBox[{"xtp1Ext00", "/.", "someLatexSubs"}], "]"}], ";"}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["Grid Spec", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"numNodes", "=", "5"}], ";", 
  RowBox[{"kVal", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"kk", "/.", "Private`kSSSub"}], "//.", "Private`tog"}], "//", 
    "N"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kLow", "=", 
   RowBox[{".01", "*", "kVal"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"kHigh", "=", 
   RowBox[{"4", "*", "kVal"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sigVal", "=", 
   RowBox[{
    RowBox[{"sigma", "//.", "Private`tog"}], "//", "N"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sigLow", "=", 
   RowBox[{
    RowBox[{"-", "3"}], "*", "sigVal"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"sigHigh", "=", 
   RowBox[{"3", "*", "sigVal"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"thLow", "=", ".9"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"thHigh", "=", "1.1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"aGSpec", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"numNodes", ",", "kLow", ",", "kHigh"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"numNodes", ",", "thLow", ",", "thHigh"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"numNodes", ",", 
       RowBox[{"3", "*", "sigLow"}], ",", 
       RowBox[{"3", "*", "sigHigh"}]}], "}"}]}], "}"}]}], 
  ";"}], "\n"}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["one time period", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "00", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"solnSubsExt00", "=", 
     RowBox[{"Private`makeConstraintFindRootFunc", "[", 
      RowBox[{"Private`hFuncExt", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Private`bmatExt", "//", "N"}], ",", 
         RowBox[{"Private`phimatExt", "//", "N"}], ",", 
         RowBox[{"Private`fmatExt", "//", "N"}], ",", 
         RowBox[{"Private`psiepsExt", "//", "N"}], ",", 
         RowBox[{"Private`psicExt", "//", "N"}], ",", 
         RowBox[{"Private`psizExt", "//", "N"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solnFuncsExt00", "=", 
     RowBox[{"Private`subsFuncToVecFunc", "[", "solnSubsExt00", "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"solnFuncsExt00PF", "=", 
     RowBox[{"Private`makeInterpFuncPF", "[", 
      RowBox[{"solnFuncsExt00", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], ",", "aGSpec", ",", "1"}], "]"}]}], 
    ";"}], "\n", "\[IndentingNewLine]"}]}]], "Input"],

Cell[CellGroupData[{

Cell["Very accurate solutions possible", "Subsection"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"anEpsVal", "=", "0.05"}], ";", 
  RowBox[{"aThVal", "=", "1"}], ";", 
  RowBox[{"kNow", "=", 
   RowBox[{"kVal", "=", 
    RowBox[{
     RowBox[{"kk", "/.", "Private`kSSSub"}], "//.", "Private`tog"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cVal", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"cc", "/.", "Private`cSSSub"}], "/.", 
      RowBox[{"theta", "\[Rule]", "1"}]}], "//.", "Private`tog"}], "//", 
    "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"someSubs", "=", 
   RowBox[{"solnSubsExt00", "[", 
    RowBox[{".1", ",", "kNow", ",", "10", ",", "aThVal", ",", "anEpsVal"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xtExt00", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Private`computeNextXt", "[", 
         RowBox[{"{", 
          RowBox[{
          "Private`bmatExt", ",", "Private`phimatExt", ",", "Private`fmatExt",
            ",", "Private`psiepsExt", ",", "Private`psicExt", ",", 
           "Private`psizExt"}], "}"}], "]"}], "//", "N"}], "//", "Expand"}], "//",
       "Simplify"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"zName_", "[", "t", "]"}], "\[Rule]", "zName"}], "}"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"xtp1Ext00", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Private`computeNextXtp1", "[", 
          RowBox[{"{", 
           RowBox[{
           "Private`bmatExt", ",", "Private`phimatExt", ",", 
            "Private`fmatExt", ",", "Private`psiepsExt", ",", 
            "Private`psicExt", ",", "Private`psizExt"}], "}"}], "]"}], "//", 
         "N"}], "//", "Expand"}], "//", "Simplify"}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"zName_", "[", "t", "]"}], "\[Rule]", "zName"}], "}"}]}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"eqnSubs", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"kk", "[", 
          RowBox[{"t", "-", "1"}], "]"}], "\[Rule]", "kNow"}], ",", 
        RowBox[{
         RowBox[{"theta", "[", 
          RowBox[{"t", "-", "1"}], "]"}], "\[Rule]", "aThVal"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"eps", "[", "theta", "]"}], "[", "t", "]"}], "\[Rule]", 
         "anEpsVal"}]}], "}"}], ",", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"cc", "[", "t", "]"}], ",", 
          RowBox[{"kk", "[", "t", "]"}], ",", 
          RowBox[{"ratioThetaToC", "[", "t", "]"}], ",", 
          RowBox[{"theta", "[", "t", "]"}], ",", 
          RowBox[{"cc", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"kk", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"ratioThetaToC", "[", 
           RowBox[{"t", "+", "1"}], "]"}], ",", 
          RowBox[{"theta", "[", 
           RowBox[{"t", "+", "1"}], "]"}]}], "}"}], "->", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xtExt00", ",", "xtp1Ext00"}], "}"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"xxxtm1Var$2", "\[Rule]", "kVal"}], ",", 
             RowBox[{"xxxtm1Var$4", "\[Rule]", "aThVal"}], ",", 
             RowBox[{"epsVar$1", "\[Rule]", "anEpsVal"}]}], "}"}]}], "/.", 
          "someSubs"}], "]"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"Private`rbcEqnsExt", "//.", "Private`tog"}], "/.", 
  "eqnSubs"}], "\n"}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"boo", "=", 
   RowBox[{"eqnErrsOnPathPF", "[", 
    RowBox[{"solnFuncsExt00", ",", 
     RowBox[{"{", 
      RowBox[{".1", ",", 
       RowBox[{"kVal", "*", "1.25"}], ",", "10", ",", ".9", ",", ".05"}], 
      "}"}], ",", "20"}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[""], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"solnFuncsExt00Interp", "=", 
   RowBox[{"Private`makeInterpFunc", "[", 
    RowBox[{"solnFuncsExt00", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", "aGSpec"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"solnFuncsExt00PF", "=", 
    RowBox[{"Private`makeInterpFuncPF", "[", 
     RowBox[{"solnFuncsExt00", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}], ",", "aGSpec", ",", "1"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ZZksExt00", "=", 
    RowBox[{"solnFuncsExt00PF", "[", 
     RowBox[{"[", 
      RowBox[{"8", "+", 
       RowBox[{"Range", "[", "4", "]"}]}], "]"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<done one\>\"", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<AMASeriesRepresentation`\>\"", "]"}]], "Input"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["two time periods", "Section"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xtExt01", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Private`computeNextXt", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "Private`bmatExt", ",", "Private`phimatExt", ",", 
             "Private`fmatExt", ",", "Private`psiepsExt", ",", 
             "Private`psicExt", ",", "Private`psizExt"}], "}"}], ",", "1"}], 
          "]"}], "//", "N"}], "//", "Expand"}], "//", "Simplify"}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"zName_", "[", "t", "]"}], "\[Rule]", "zName"}], "}"}]}]}], 
   ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xtp1Ext01", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Private`computeNextXtp1", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "Private`bmatExt", ",", "Private`phimatExt", ",", 
            "Private`fmatExt", ",", "Private`psiepsExt", ",", 
            "Private`psicExt", ",", "Private`psizExt"}], "}"}], ",", "1"}], 
         "]"}], "//", "N"}], "//", "Expand"}], "//", "Simplify"}], ")"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"zName_", "[", "t", "]"}], "\[Rule]", "zName"}], "}"}]}]}], 
  ";"}], "\n"}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"solnSubsExt01", "=", 
   RowBox[{"Private`makeConstraintFixedPointFunc", "[", 
    RowBox[{"Private`hFuncExt", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Private`bmatExt", "//", "N"}], ",", 
       RowBox[{"Private`phimatExt", "//", "N"}], ",", 
       RowBox[{"Private`fmatExt", "//", "N"}], ",", 
       RowBox[{"Private`psiepsExt", "//", "N"}], ",", 
       RowBox[{"Private`psicExt", "//", "N"}], ",", 
       RowBox[{"Private`psizExt", "//", "N"}]}], "}"}], ",", 
     RowBox[{"solnFuncsExt00PF", "[", 
      RowBox[{"[", 
       RowBox[{"8", "+", 
        RowBox[{"Range", "[", "4", "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", ".2", "}"}], ",", 
       RowBox[{"{", ".3", "}"}], ",", 
       RowBox[{"{", ".2", "}"}], ",", 
       RowBox[{"{", ".9", "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"solnFuncsExt01", "=", 
   RowBox[{"Private`subsFuncToVecFunc", "[", "solnSubsExt01", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"solnFuncsExt01PF", "=", 
    RowBox[{"Private`makeInterpFuncPF", "[", 
     RowBox[{"solnFuncsExt00", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}], ",", "aGSpec", ",", "1"}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\n"}], "Input"],

Cell[BoxData[
 RowBox[{"solnFuncsExt01", "[", 
  RowBox[{"{", 
   RowBox[{".1", ",", ".18", ",", "10", ",", "1", ",", "0"}], "}"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"boo", "=", 
  RowBox[{"eqnErrsOnPathPF", "[", 
   RowBox[{"solnFuncsExt01", ",", 
    RowBox[{"{", 
     RowBox[{".1", ",", "kVal", ",", "10", ",", "1", ",", "0"}], "}"}], ",", 
    "10"}], "]"}]}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["TeXForm for paper", "Section"],

Cell[BoxData[
 RowBox[{
  RowBox[{"moreLatexSubs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"epsVar$1", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"epsilon", ",", "t"}], "]"}]}], ",", 
     RowBox[{"xxxtm1Var$2", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"k", ",", 
        RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{"xxxtm1Var$4", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"theta", ",", 
        RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{"zzz$0$1", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"z1", ",", 
        RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{"zzz$0$2", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"z2", ",", 
        RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{"zzz$0$3", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"z3", ",", 
        RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{"zzz$0$4", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"z4", ",", 
        RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{"zzz$1$1", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"Z1", ",", 
        RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{"zzz$1$2", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"Z2", ",", 
        RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{"zzz$1$3", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"Z3", ",", 
        RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
     RowBox[{"zzz$1$4", "\[Rule]", 
      RowBox[{"Subscript", "[", 
       RowBox[{"Z4", ",", 
        RowBox[{"t", "-", "1"}]}], "]"}]}]}], "}"}]}], ";"}]], "Input"],

Cell[BoxData["xtExt01"], "Input"],

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"xtExt01", "/.", "someLatexSubs"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"xtp1Ext01", "/.", "someLatexSubs"}], "]"}]], "Input"],

Cell[BoxData["xtExt01"], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Private`phimatExt", " ", ".", " ", "Private`fmatExt"}], "//", 
   "N"}], "\[IndentingNewLine]"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"initFPGuess", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "cVal", "}"}], ",", 
      RowBox[{"{", "kVal", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", "/", "cVal"}], "}"}], ",", 
      RowBox[{"{", "1", "}"}]}], "}"}]}], ";"}], "\n", 
  RowBox[{"(*", "01", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"solnSubsExt01", "=", 
    RowBox[{"Private`makeConstraintFixedPointFunc", "[", 
     RowBox[{"Private`hFuncExt", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Private`bmatExt", "//", "N"}], ",", 
        RowBox[{"Private`phimatExt", "//", "N"}], ",", 
        RowBox[{"Private`fmatExt", "//", "N"}], ",", 
        RowBox[{"Private`psiepsExt", "//", "N"}], ",", 
        RowBox[{"Private`psicExt", "//", "N"}], ",", 
        RowBox[{"Private`psizExt", "//", "N"}]}], "}"}], ",", "ZZksExt00", 
      ",", 
      RowBox[{"{", "}"}], ",", "initFPGuess", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solnFuncsExt01", "=", 
   RowBox[{"Private`subsFuncToVecFunc", "[", "solnSubsExt01", "]"}]}], 
  ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{"solnSubsExt01", "[", 
  RowBox[{".1", ",", ".18", ",", "10", ",", "1", ",", "0"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"??", "solnSubsExt01"}]], "Input"],

Cell[BoxData[{
 RowBox[{"solnFuncsExt01Interp", "=", 
  RowBox[{"Private`makeInterpFunc", "[", 
   RowBox[{"solnFuncsExt01", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}], ",", "aGSpec"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"solnFuncsExt01PF", "=", 
   RowBox[{"Private`makeInterpFuncPF", "[", 
    RowBox[{"solnFuncsExt01", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3"}], "}"}], ",", "aGSpec", ",", "1"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"ZZksExt01", "=", 
   RowBox[{"Private`prepNextZZksPForRE", "[", 
    RowBox[{
     RowBox[{"solnFuncsExt01Interp", "[", 
      RowBox[{"[", 
       RowBox[{"{", 
        RowBox[{"2", ",", "4"}], "}"}], "]"}], "]"}], ",", 
     RowBox[{"solnFuncsExt01PF", "[", 
      RowBox[{"[", 
       RowBox[{"8", "+", 
        RowBox[{"Range", "[", "4", "]"}]}], "]"}], "]"}], ",", "ZZksExt00", 
     ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{"Print", "[", "\"\<done one\>\"", "]"}], "\n"}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "02", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"solnSubsExt02", "=", 
     RowBox[{"Private`makeConstraintFixedPointFunc", "[", 
      RowBox[{"Private`hFuncExt", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Private`bmatExt", "//", "N"}], ",", 
         RowBox[{"Private`phimatExt", "//", "N"}], ",", 
         RowBox[{"Private`fmatExt", "//", "N"}], ",", 
         RowBox[{"Private`psiepsExt", "//", "N"}], ",", 
         RowBox[{"Private`psicExt", "//", "N"}], ",", 
         RowBox[{"Private`psizExt", "//", "N"}]}], "}"}], ",", "ZZksExt01", 
       ",", 
       RowBox[{"{", "}"}], ",", "initFPGuess", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"solnFuncsExt02", "=", 
     RowBox[{"Private`subsFuncToVecFunc", "[", "solnSubsExt02", "]"}]}], 
    ";"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "00", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"solnSubsExt00", "=", 
     RowBox[{"Private`makeConstraintFindRootFunc", "[", 
      RowBox[{"Private`hFuncExt", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Private`bmatExt", "//", "N"}], ",", 
         RowBox[{"Private`phimatExt", "//", "N"}], ",", 
         RowBox[{"Private`fmatExt", "//", "N"}], ",", 
         RowBox[{"Private`psiepsExt", "//", "N"}], ",", 
         RowBox[{"Private`psicExt", "//", "N"}], ",", 
         RowBox[{"Private`psizExt", "//", "N"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solnFuncsExt00", "=", 
     RowBox[{"Private`subsFuncToVecFunc", "[", "solnSubsExt00", "]"}]}], 
    ";"}], "\n"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"anEpsVal", "=", "0.05"}], ";", 
  RowBox[{"aThVal", "=", "1"}], ";", 
  RowBox[{"kNow", "=", "kVal"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"someSubs", "=", 
   RowBox[{"solnSubsExt00", "[", 
    RowBox[{".1", ",", "kNow", ",", "10", ",", "aThVal", ",", "anEpsVal"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"eqnSubs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"kk", "[", 
         RowBox[{"t", "-", "1"}], "]"}], "\[Rule]", "kNow"}], ",", 
       RowBox[{
        RowBox[{"theta", "[", 
         RowBox[{"t", "-", "1"}], "]"}], "\[Rule]", "aThVal"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"eps", "[", "theta", "]"}], "[", "t", "]"}], "\[Rule]", 
        "anEpsVal"}]}], "}"}], ",", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cc", "[", "t", "]"}], ",", 
         RowBox[{"kk", "[", "t", "]"}], ",", 
         RowBox[{"ratioThetaToC", "[", "t", "]"}], ",", 
         RowBox[{"theta", "[", "t", "]"}], ",", 
         RowBox[{"cc", "[", 
          RowBox[{"t", "+", "1"}], "]"}], ",", 
         RowBox[{"kk", "[", 
          RowBox[{"t", "+", "1"}], "]"}], ",", 
         RowBox[{"ratioThetaToC", "[", 
          RowBox[{"t", "+", "1"}], "]"}], ",", 
         RowBox[{"theta", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], "}"}], "->", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xtExt00", ",", "xtp1Ext00"}], "}"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xxxtm1Var$2", "\[Rule]", "kVal"}], ",", 
            RowBox[{"xxxtm1Var$4", "\[Rule]", "aThVal"}], ",", 
            RowBox[{"epsVar$1", "\[Rule]", "anEpsVal"}]}], "}"}]}], "/.", 
         "someSubs"}], "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\n"}], "\n"}], "Input"],

Cell["substuting into equation satisfies the non linear system", "Text"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"kk", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "t"}], "]"}], "\[Rule]", 
    "0.18703194520402708`"}], ",", 
   RowBox[{
    RowBox[{"theta", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "t"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"eps", "[", "theta", "]"}], "[", "t", "]"}], "\[Rule]", 
    "0.05`"}], ",", 
   RowBox[{
    RowBox[{"cc", "[", "t", "]"}], "\[Rule]", "0.37837490370115007`"}], ",", 
   RowBox[{
    RowBox[{"kk", "[", "t", "]"}], "\[Rule]", "0.19654111411165118`"}], ",", 
   RowBox[{
    RowBox[{"ratioThetaToC", "[", "t", "]"}], "\[Rule]", 
    "2.7783848402544797`"}], ",", 
   RowBox[{
    RowBox[{"theta", "[", "t", "]"}], "\[Rule]", "1.0512710963760241`"}], ",", 
   RowBox[{
    RowBox[{"cc", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", "0.3839586077875613`"}], ",", 
   RowBox[{
    RowBox[{"kk", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", "0.1995651122543251`"}], ",", 
   RowBox[{
    RowBox[{"ratioThetaToC", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", "2.728109231646098`"}], ",", 
   RowBox[{
    RowBox[{"theta", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", "1.048707541557223`"}]}], 
  "}"}]], "Output"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"Private`rbcEqnsExt", "//.", "Private`tog"}], ")"}], "/.", 
  "eqnSubs"}]], "Input"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{787, 873},
WindowMargins->{{Automatic, -1310}, {Automatic, 47}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{612, 792}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
TrackCellChangeTimes->False,
FrontEndVersion->"10.2 for Microsoft Windows (64-bit) (July 7, 2015)",
StyleDefinitions->"Default.nb",
$CellContext`TrackCellChangeTimes -> False
]
