(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     80110,       2072]
NotebookOptionsPosition[     73979,       1877]
NotebookOutlinePosition[     74958,       1907]
CellTagsIndexPosition[     74792,       1901]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Verify RBC Calculations", "Title",
 CellChangeTimes->{{3.652617205212658*^9, 3.6526172115626574`*^9}},
 TextAlignment->Center],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Switch", "[", 
   RowBox[{
   "$System", ",", "\[IndentingNewLine]", "\"\<Mac OS X x86 (64-bit)\>\"", 
    ",", 
    RowBox[{
    "SetDirectory", "[", 
     "\"\</Users/garyanderson/git/ProjectionMethodTools/\
ProjectionMethodToolsJava/code\>\"", "]"}]}], "]"}], ";", 
  RowBox[{"Needs", "[", "\"\<simpleRBCModel`\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.650907988647554*^9, 3.650907998212325*^9}, {
   3.6509100314215813`*^9, 3.650910061208927*^9}, {3.650910199769527*^9, 
   3.650910200851472*^9}, {3.6512586525749536`*^9, 3.651258654404935*^9}, {
   3.6526173170726576`*^9, 3.6526173184226575`*^9}, {3.652632616569953*^9, 
   3.652632626328315*^9}, {3.652632670214761*^9, 3.652632699200892*^9}, {
   3.6526327324685907`*^9, 3.652632745960478*^9}, 3.6527190601656733`*^9}],

Cell[CellGroupData[{

Cell[BoxData["\<\"reading simpleRBCModel.m\"\>"], "Print",
 CellChangeTimes->{3.6528057011558857`*^9, 3.652806503826634*^9, 
  3.652807727794038*^9, 3.652809441162875*^9, 3.652977251940692*^9}],

Cell[BoxData["\<\"done reading AMAModel\"\>"], "Print",
 CellChangeTimes->{3.6528057011558857`*^9, 3.652806503826634*^9, 
  3.652807727794038*^9, 3.652809441162875*^9, 3.652977251950458*^9}],

Cell[BoxData["\<\"done reading SymbolicAMA\"\>"], "Print",
 CellChangeTimes->{3.6528057011558857`*^9, 3.652806503826634*^9, 
  3.652807727794038*^9, 3.652809441162875*^9, 3.6529772519595118`*^9}],

Cell[BoxData["\<\"done reading SymbolicAMA init.m\"\>"], "Print",
 CellChangeTimes->{3.6528057011558857`*^9, 3.652806503826634*^9, 
  3.652807727794038*^9, 3.652809441162875*^9, 3.652977251971676*^9}],

Cell[BoxData["\<\"done reading NumericAMA\"\>"], "Print",
 CellChangeTimes->{3.6528057011558857`*^9, 3.652806503826634*^9, 
  3.652807727794038*^9, 3.652809441162875*^9, 3.652977251981447*^9}],

Cell[BoxData["\<\"done numericaim init.m\"\>"], "Print",
 CellChangeTimes->{3.6528057011558857`*^9, 3.652806503826634*^9, 
  3.652807727794038*^9, 3.652809441162875*^9, 3.652977251997986*^9}],

Cell[BoxData["\<\"computing steady state subs\"\>"], "Print",
 CellChangeTimes->{3.6528057011558857`*^9, 3.652806503826634*^9, 
  3.652807727794038*^9, 3.652809441162875*^9, 3.652977252010541*^9}],

Cell[BoxData["\<\"computing and simplifying the symbolic b phi f etc\"\>"], \
"Print",
 CellChangeTimes->{3.6528057011558857`*^9, 3.652806503826634*^9, 
  3.652807727794038*^9, 3.652809441162875*^9, 3.6529772532373533`*^9}],

Cell[BoxData["\<\"computing and simplifying the symbolic b phi f etc\"\>"], \
"Print",
 CellChangeTimes->{3.6528057011558857`*^9, 3.652806503826634*^9, 
  3.652807727794038*^9, 3.652809441162875*^9, 3.65297725324647*^9}],

Cell[BoxData["\<\"computing and simplifying the symbolic b phi f etc\"\>"], \
"Print",
 CellChangeTimes->{3.6528057011558857`*^9, 3.652806503826634*^9, 
  3.652807727794038*^9, 3.652809441162875*^9, 3.6529772532892637`*^9}],

Cell[BoxData["\<\"defining constraint and selector funcs\"\>"], "Print",
 CellChangeTimes->{3.6528057011558857`*^9, 3.652806503826634*^9, 
  3.652807727794038*^9, 3.652809441162875*^9, 3.652977253325404*^9}],

Cell[BoxData["\<\"done reading simpleRBCModel.m\"\>"], "Print",
 CellChangeTimes->{3.6528057011558857`*^9, 3.652806503826634*^9, 
  3.652807727794038*^9, 3.652809441162875*^9, 3.652977253334217*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"??", "genZVars"}]], "Input",
 CellChangeTimes->{{3.6528077356811247`*^9, 3.652807740523926*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"genZVars[horizons_Integer,numConstr_Integer,offset_Integer]\"\>\
", "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.652977266654665*^9},
 CellTags->"Info-6582d735-f446-442d-a9a0-ce139752c70e"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{"genZVars", "[", "Private`numConstr_Integer", "]"}], ":=", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"genZVars", "[", 
             RowBox[{"0", ",", "Private`numConstr"}], "]"}], "]"}], "]"}], "/;", 
          RowBox[{"And", "[", 
           RowBox[{"Private`numConstr", "\[GreaterEqual]", "0"}], "]"}]}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"genZVars", "[", 
          RowBox[{
          "Private`horizons_Integer", ",", "Private`numConstr_Integer"}], 
          "]"}], ":=", 
         RowBox[{"genZVars", "[", 
          RowBox[{"Private`horizons", ",", "Private`numConstr", ",", "0"}], 
          "]"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"genZVars", "[", 
          RowBox[{
          "Private`horizons_Integer", ",", "Private`numConstr_Integer", ",", 
           "Private`offset_Integer"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{
             RowBox[{"genZVars", "[", 
              RowBox[{
              "Private`horizons", ",", "Private`numConstr", ",", 
               "Private`offset"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"makeProtectedSymbol", "[", 
                  RowBox[{"\<\"zzz$\"\>", "<>", 
                   RowBox[{"ToString", "[", "Private`forTime", "]"}], 
                   "<>", "\<\"$\"\>", "<>", 
                   RowBox[{"ToString", "[", "Private`ii", "]"}]}], "]"}], "[",
                  "t", "]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Private`forTime", ",", 
                 RowBox[{"0", "-", "Private`offset"}], ",", 
                 "Private`horizons"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Private`ii", ",", "Private`numConstr", ",", "1", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}], "]"}], "/;", 
          RowBox[{"Private`offset", "\[LessEqual]", "0"}]}]}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[AMASeriesRepresentation`genZVars],
  Editable->False]], "Print",
 CellChangeTimes->{3.652977266706119*^9},
 CellTags->"Info-6582d735-f446-442d-a9a0-ce139752c70e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Demonstrate approximation with arbitrary reference matrix", "Section",
 CellChangeTimes->{{3.6527814279268093`*^9, 3.6527814419381437`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<demoApprox.mth\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.652781449145309*^9, 3.652781460339121*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"using version in eclipse\"\>"], "Print",
 CellChangeTimes->{3.652781574538106*^9, 3.652805334255028*^9, 
  3.65280536930153*^9, 3.6528057025292883`*^9, 3.652806505398181*^9, 
  3.652807755390686*^9, 3.652809443389571*^9, 3.6529772817632837`*^9}],

Cell[BoxData["\<\"start iZNorms\"\>"], "Print",
 CellChangeTimes->{3.652781574538106*^9, 3.652805334255028*^9, 
  3.65280536930153*^9, 3.6528057025292883`*^9, 3.652806505398181*^9, 
  3.652807755390686*^9, 3.652809443389571*^9, 3.652977282528933*^9}],

Cell[BoxData["1"], "Print",
 CellChangeTimes->{3.652781574538106*^9, 3.652805334255028*^9, 
  3.65280536930153*^9, 3.6528057025292883`*^9, 3.652806505398181*^9, 
  3.652807755390686*^9, 3.652809443389571*^9, 3.652977282538024*^9}],

Cell[BoxData["2"], "Print",
 CellChangeTimes->{3.652781574538106*^9, 3.652805334255028*^9, 
  3.65280536930153*^9, 3.6528057025292883`*^9, 3.652806505398181*^9, 
  3.652807755390686*^9, 3.652809443389571*^9, 3.6529772832047*^9}],

Cell[BoxData["3"], "Print",
 CellChangeTimes->{3.652781574538106*^9, 3.652805334255028*^9, 
  3.65280536930153*^9, 3.6528057025292883`*^9, 3.652806505398181*^9, 
  3.652807755390686*^9, 3.652809443389571*^9, 3.652977284397195*^9}],

Cell[BoxData["4"], "Print",
 CellChangeTimes->{3.652781574538106*^9, 3.652805334255028*^9, 
  3.65280536930153*^9, 3.6528057025292883`*^9, 3.652806505398181*^9, 
  3.652807755390686*^9, 3.652809443389571*^9, 3.652977286066359*^9}],

Cell[BoxData["5"], "Print",
 CellChangeTimes->{3.652781574538106*^9, 3.652805334255028*^9, 
  3.65280536930153*^9, 3.6528057025292883`*^9, 3.652806505398181*^9, 
  3.652807755390686*^9, 3.652809443389571*^9, 3.652977288386747*^9}],

Cell[BoxData["\<\"done iZNorms\"\>"], "Print",
 CellChangeTimes->{3.652781574538106*^9, 3.652805334255028*^9, 
  3.65280536930153*^9, 3.6528057025292883`*^9, 3.652806505398181*^9, 
  3.652807755390686*^9, 3.652809443389571*^9, 3.652977290705843*^9}],

Cell[BoxData["\<\"start iGNorms\"\>"], "Print",
 CellChangeTimes->{3.652781574538106*^9, 3.652805334255028*^9, 
  3.65280536930153*^9, 3.6528057025292883`*^9, 3.652806505398181*^9, 
  3.652807755390686*^9, 3.652809443389571*^9, 3.652977290716566*^9}],

Cell[BoxData["1"], "Print",
 CellChangeTimes->{3.652781574538106*^9, 3.652805334255028*^9, 
  3.65280536930153*^9, 3.6528057025292883`*^9, 3.652806505398181*^9, 
  3.652807755390686*^9, 3.652809443389571*^9, 3.652977290727215*^9}],

Cell[BoxData["2"], "Print",
 CellChangeTimes->{3.652781574538106*^9, 3.652805334255028*^9, 
  3.65280536930153*^9, 3.6528057025292883`*^9, 3.652806505398181*^9, 
  3.652807755390686*^9, 3.652809443389571*^9, 3.652977291689049*^9}],

Cell[BoxData["3"], "Print",
 CellChangeTimes->{3.652781574538106*^9, 3.652805334255028*^9, 
  3.65280536930153*^9, 3.6528057025292883`*^9, 3.652806505398181*^9, 
  3.652807755390686*^9, 3.652809443389571*^9, 3.652977293175517*^9}],

Cell[BoxData["4"], "Print",
 CellChangeTimes->{3.652781574538106*^9, 3.652805334255028*^9, 
  3.65280536930153*^9, 3.6528057025292883`*^9, 3.652806505398181*^9, 
  3.652807755390686*^9, 3.652809443389571*^9, 3.652977295270021*^9}],

Cell[BoxData["5"], "Print",
 CellChangeTimes->{3.652781574538106*^9, 3.652805334255028*^9, 
  3.65280536930153*^9, 3.6528057025292883`*^9, 3.652806505398181*^9, 
  3.652807755390686*^9, 3.652809443389571*^9, 3.6529772964166517`*^9}],

Cell[BoxData["\<\"done iGNorms\"\>"], "Print",
 CellChangeTimes->{3.652781574538106*^9, 3.652805334255028*^9, 
  3.65280536930153*^9, 3.6528057025292883`*^9, 3.652806505398181*^9, 
  3.652807755390686*^9, 3.652809443389571*^9, 3.6529772977255096`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["RBC Model Example", "Section",
 CellChangeTimes->{{3.6527836692010927`*^9, 3.6527836754780407`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", "\"\<AMAPaperCalcs.mth\>\"", "]"}], 
  "         "}]], "Input",
 CellChangeTimes->{{3.65278367780569*^9, 3.652783690890202*^9}, {
  3.6530519168916197`*^9, 3.653051920254273*^9}}],

Cell[BoxData["\<\"make sure simpleRBCModel.m computes the symbolic bmat etc\"\
\>"], "Print",
 CellChangeTimes->{3.652783692899344*^9, 3.652805351228498*^9, 
  3.652805382630644*^9, 3.652805713732601*^9, 3.652806522116035*^9, 
  3.652809459827935*^9, 3.6529773072496967`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<paperCalcsRBCExample.mth\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.652783822041423*^9, 3.652783839069151*^9}}],

Cell[BoxData["\<\"make sure simpleRBCModel.m computes the symbolic bmat etc\"\
\>"], "Print",
 CellChangeTimes->{3.652783839736805*^9, 3.652805352037396*^9, 
  3.652805383496727*^9, 3.65280571450963*^9, 3.6528065229210453`*^9, 
  3.652809460456564*^9, 3.6528113587586927`*^9, 3.652977308156831*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "inumr"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The integrand \
\[NoBreak]\\!\\(\\(\\(\\*TagBox[\\(InterpolatingFunction[\\(\\(\\(\\({\\(\\({\
0.0018703194520402707`, 0.7481277808161083`}\\)\\), \\(\\({0.9`, 1.1`}\\)\\), \
\\(\\({\\(\\(-0.03`\\)\\), 0.08999999999999998`}\\)\\)}\\)\\), \\(\\({5, 3, \
0, \\(\\({5, 4, 4}\\)\\), \\(\\({2, 2, 2}\\)\\), 0, 0, 0, 0, Automatic, \
\\(\\({}\\)\\), \\(\\({}\\)\\), False}\\)\\), \
\\(\\({\\(\\({0.0018703194520402707`, 0.18843468479305728`, \\(\\(\
\[LeftSkeleton] 20 \[RightSkeleton]\\)\\), 0.5615634154750914`, \
0.7481277808161083`}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\)}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\), \\(\\({Automatic, Automatic, \
Automatic}\\)\\)\\)\\)]\\), False, Rule[Editable, False], \
Rule[SelectWithContents, True]]\\)\\)[\\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\)]\\)\[NoBreak] has evaluated to non-numerical values \
for all sampling points in the region with boundaries \[NoBreak]\\!\\({\\({0, \
1}\\)}\\)\[NoBreak]. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/inumr\\\", ButtonNote -> \
\\\"NIntegrate::inumr\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.652783855969865*^9, 3.652805368043816*^9, 
  3.652805399665182*^9, 3.652805727460531*^9, 3.652806538722053*^9, 
  3.652809478480171*^9, 3.652811374585719*^9, 3.65297734871303*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "inumr"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The integrand \[NoBreak]\\!\\(\\(\\(\\*TagBox[\\(\
\[LeftSkeleton] 1 \[RightSkeleton]\\), False, Rule[Editable, False], \
Rule[SelectWithContents, True]]\\)\\)[\\(\\(0.0018703194520402707`, 0.9`, \\(\
\\(ConditionalExpression[\\(\\(\\(\\(-\\(\\(\\(InverseErfc[\\(\\(2\\\\ \
Statistics`NExpectationDump`p$159898\\)\\)]\\)\\/\\(50\\\\ \
\\@2\\)\\)\\)\\)\\), \\(\\(0 \[LessEqual] \
Statistics`NExpectationDump`p$159898 \[LessEqual] 1\\)\\)\\)\\)]\\)\\)\\)\\)]\
\\)\[NoBreak] has evaluated to non-numerical values for all sampling points \
in the region with boundaries \[NoBreak]\\!\\({\\({0, 1}\\)}\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/NIntegrate/inumr\\\", \
ButtonNote -> \\\"NIntegrate::inumr\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.652783855969865*^9, 3.652805368043816*^9, 
  3.652805399665182*^9, 3.652805727460531*^9, 3.652806538722053*^9, 
  3.652809478480171*^9, 3.652811374585719*^9, 3.652977348778414*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "inumr"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The integrand \
\[NoBreak]\\!\\(\\(\\(\\*TagBox[\\(InterpolatingFunction[\\(\\(\\(\\({\\(\\({\
0.0018703194520402707`, 0.7481277808161083`}\\)\\), \\(\\({0.9`, 1.1`}\\)\\), \
\\(\\({\\(\\(-0.03`\\)\\), 0.08999999999999998`}\\)\\)}\\)\\), \\(\\(\
\[LeftSkeleton] 3 \[RightSkeleton]\\)\\), \\(\\({Automatic, Automatic, \
Automatic}\\)\\)\\)\\)]\\), False, Rule[Editable, False], \
Rule[SelectWithContents, True]]\\)\\)[\\(\\(0.0018703194520402707`, 0.9`, \\(\
\\(ConditionalExpression[\\(\\(\\(\\(-\\(\\(\\(InverseErfc[\\(\\(2\\\\ \
Statistics`NExpectationDump`p$159898\\)\\)]\\)\\/\\(50\\\\ \
\\@2\\)\\)\\)\\)\\), \\(\\(0 \[LessEqual] \
Statistics`NExpectationDump`p$159898 \[LessEqual] 1\\)\\)\\)\\)]\\)\\)\\)\\)]\
\\)\[NoBreak] has evaluated to non-numerical values for all sampling points \
in the region with boundaries \[NoBreak]\\!\\({\\({0, 1}\\)}\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/NIntegrate/inumr\\\", \
ButtonNote -> \\\"NIntegrate::inumr\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.652783855969865*^9, 3.652805368043816*^9, 
  3.652805399665182*^9, 3.652805727460531*^9, 3.652806538722053*^9, 
  3.652809478480171*^9, 3.652811374585719*^9, 3.6529773488448277`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(NIntegrate :: inumr\\), \
\\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.652783855969865*^9, 3.652805368043816*^9, 
  3.652805399665182*^9, 3.652805727460531*^9, 3.652806538722053*^9, 
  3.652809478480171*^9, 3.652811374585719*^9, 3.652977348884612*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "wprec"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Value of option WorkingPrecision -> \
\[NoBreak]\\!\\(Statistics`NExpectationDump`$NExpectationWorkingPrecision\\)\
\[NoBreak] is not a positive machine-sized real or integer. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/NIntegrate\\\", ButtonNote -> \
\\\"NIntegrate::wprec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.652783855969865*^9, 3.652805368043816*^9, 
  3.652805399665182*^9, 3.652805727460531*^9, 3.652806538722053*^9, 
  3.652809478480171*^9, 3.652811374585719*^9, 3.652977350382451*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "wprec"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Value of option WorkingPrecision -> \
\[NoBreak]\\!\\(Statistics`NExpectationDump`$NExpectationWorkingPrecision\\)\
\[NoBreak] is not a positive machine-sized real or integer. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/NIntegrate\\\", ButtonNote -> \
\\\"NIntegrate::wprec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.652783855969865*^9, 3.652805368043816*^9, 
  3.652805399665182*^9, 3.652805727460531*^9, 3.652806538722053*^9, 
  3.652809478480171*^9, 3.652811374585719*^9, 3.652977350453582*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "wprec"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Value of option WorkingPrecision -> \
\[NoBreak]\\!\\(Statistics`NExpectationDump`$NExpectationWorkingPrecision\\)\
\[NoBreak] is not a positive machine-sized real or integer. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/NIntegrate\\\", ButtonNote -> \
\\\"NIntegrate::wprec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.652783855969865*^9, 3.652805368043816*^9, 
  3.652805399665182*^9, 3.652805727460531*^9, 3.652806538722053*^9, 
  3.652809478480171*^9, 3.652811374585719*^9, 3.65297735052744*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(NIntegrate :: wprec\\), \
\\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.652783855969865*^9, 3.652805368043816*^9, 
  3.652805399665182*^9, 3.652805727460531*^9, 3.652806538722053*^9, 
  3.652809478480171*^9, 3.652811374585719*^9, 3.6529773505695477`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "ncvb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"NIntegrate failed to converge to prescribed accuracy after \
\[NoBreak]\\!\\(9\\)\[NoBreak] recursive bisections in \
\[NoBreak]\\!\\(Statistics`NExpectationDump`p$709746\\)\[NoBreak] near \
\[NoBreak]\\!\\({Statistics`NExpectationDump`p$709746}\\)\[NoBreak] = \
\[NoBreak]\\!\\({0.8417813333594676`}\\)\[NoBreak]. NIntegrate obtained \
\[NoBreak]\\!\\(-0.00002960271591633173`\\)\[NoBreak] and \
\[NoBreak]\\!\\(3.2644296091824856`*^-11\\)\[NoBreak] for the integral and \
error estimates. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\
\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/ncvb\\\", ButtonNote -> \
\\\"NIntegrate::ncvb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.652783855969865*^9, 3.652805368043816*^9, 
  3.652805399665182*^9, 3.652805727460531*^9, 3.652806538722053*^9, 
  3.652809478480171*^9, 3.652811374585719*^9, 3.6529774593897133`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "ncvb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"NIntegrate failed to converge to prescribed accuracy after \
\[NoBreak]\\!\\(9\\)\[NoBreak] recursive bisections in \
\[NoBreak]\\!\\(Statistics`NExpectationDump`p$1444262\\)\[NoBreak] near \
\[NoBreak]\\!\\({Statistics`NExpectationDump`p$1444262}\\)\[NoBreak] = \
\[NoBreak]\\!\\({0.8417813333594676`}\\)\[NoBreak]. NIntegrate obtained \
\[NoBreak]\\!\\(-0.00002960271591633173`\\)\[NoBreak] and \
\[NoBreak]\\!\\(3.2644296091824856`*^-11\\)\[NoBreak] for the integral and \
error estimates. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\
\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/ncvb\\\", ButtonNote -> \
\\\"NIntegrate::ncvb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.652783855969865*^9, 3.652805368043816*^9, 
  3.652805399665182*^9, 3.652805727460531*^9, 3.652806538722053*^9, 
  3.652809478480171*^9, 3.652811374585719*^9, 3.652977611555676*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NIntegrate", "::", "ncvb"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"NIntegrate failed to converge to prescribed accuracy after \
\[NoBreak]\\!\\(9\\)\[NoBreak] recursive bisections in \
\[NoBreak]\\!\\(Statistics`NExpectationDump`p$2179348\\)\[NoBreak] near \
\[NoBreak]\\!\\({Statistics`NExpectationDump`p$2179348}\\)\[NoBreak] = \
\[NoBreak]\\!\\({0.8417813333594676`}\\)\[NoBreak]. NIntegrate obtained \
\[NoBreak]\\!\\(-0.00002960271591633173`\\)\[NoBreak] and \
\[NoBreak]\\!\\(3.2644296091824856`*^-11\\)\[NoBreak] for the integral and \
error estimates. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\
\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/NIntegrate/ncvb\\\", ButtonNote -> \
\\\"NIntegrate::ncvb\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.652783855969865*^9, 3.652805368043816*^9, 
  3.652805399665182*^9, 3.652805727460531*^9, 3.652806538722053*^9, 
  3.652809478480171*^9, 3.652811374585719*^9, 3.652977763538101*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[\\(NIntegrate :: ncvb\\), \\\"MessageName\\\"]\\)\
\[NoBreak] will be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.652783855969865*^9, 3.652805368043816*^9, 
  3.652805399665182*^9, 3.652805727460531*^9, 3.652806538722053*^9, 
  3.652809478480171*^9, 3.652811374585719*^9, 3.652977763586478*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.652811389549961*^9, 3.652811394072385*^9}}]
}, Open  ]],

Cell["Parameters for Interpolation", "Section",
 CellChangeTimes->{{3.652781507132646*^9, 3.652781543265167*^9}}],

Cell[CellGroupData[{

Cell["one time period", "Section",
 CellChangeTimes->{{3.652721356923748*^9, 3.652721360660366*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"xtExt00", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Private`computeNextXt", "[", 
        RowBox[{"{", 
         RowBox[{
         "Private`bmatExt", ",", "Private`phimatExt", ",", "Private`fmatExt", 
          ",", "Private`psiepsExt", ",", "Private`psicExt", ",", 
          "Private`psizExt"}], "}"}], "]"}], "//", "N"}], "//", "Expand"}], "//",
      "Simplify"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xtp1Ext00", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Private`computeNextXtp1", "[", 
       RowBox[{"{", 
        RowBox[{
        "Private`bmatExt", ",", "Private`phimatExt", ",", "Private`fmatExt", 
         ",", "Private`psiepsExt", ",", "Private`psicExt", ",", 
         "Private`psizExt"}], "}"}], "]"}], "//", "N"}], "//", "Expand"}], "//",
     "Simplify"}]}], ";"}], "\n"}], "Input",
 CellChangeTimes->{{3.652633138097465*^9, 3.6526331597756767`*^9}, {
  3.6528005365077972`*^9, 3.6528005397701817`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"someLatexSubs", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"epsVar$1", "\[Rule]", 
     RowBox[{"Subscript", "[", 
      RowBox[{"epsilon", ",", "t"}], "]"}]}], ",", 
    RowBox[{"xxxtm1Var$2", "\[Rule]", 
     RowBox[{"Subscript", "[", 
      RowBox[{"k", ",", 
       RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
    RowBox[{"xxxtm1Var$4", "\[Rule]", 
     RowBox[{"Subscript", "[", 
      RowBox[{"theta", ",", 
       RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"zzz$0$1", "[", "t", "]"}], "\[Rule]", 
     RowBox[{"Subscript", "[", 
      RowBox[{"z1", ",", 
       RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"zzz$0$2", "[", "t", "]"}], "\[Rule]", 
     RowBox[{"Subscript", "[", 
      RowBox[{"z2", ",", 
       RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"zzz$0$3", "[", "t", "]"}], "\[Rule]", 
     RowBox[{"Subscript", "[", 
      RowBox[{"z3", ",", 
       RowBox[{"t", "-", "1"}]}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"zzz$0$4", "[", "t", "]"}], "\[Rule]", 
     RowBox[{"Subscript", "[", 
      RowBox[{"z4", ",", 
       RowBox[{"t", "-", "1"}]}], "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.652800568127356*^9, 3.652800607594343*^9}, {
  3.652800659562723*^9, 3.652800694751944*^9}, {3.6528007605760517`*^9, 
  3.6528008028953047`*^9}, {3.652800837993744*^9, 3.6528008951834497`*^9}, {
  3.652800935075489*^9, 3.6528009601737328`*^9}, {3.6528081449181128`*^9, 
  3.652808166107913*^9}, {3.652808217055882*^9, 3.652808242899984*^9}, {
  3.652808325481564*^9, 3.6528083392084217`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"epsVar$1", "\[Rule]", 
    SubscriptBox["epsilon", "t"]}], ",", 
   RowBox[{"xxxtm1Var$2", "\[Rule]", 
    SubscriptBox["k", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "t"}]]}], ",", 
   RowBox[{"xxxtm1Var$4", "\[Rule]", 
    SubscriptBox["theta", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "t"}]]}], ",", 
   RowBox[{
    RowBox[{"zzz$0$1", "[", "t", "]"}], "\[Rule]", 
    SubscriptBox["z1", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "t"}]]}], ",", 
   RowBox[{
    RowBox[{"zzz$0$2", "[", "t", "]"}], "\[Rule]", 
    SubscriptBox["z2", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "t"}]]}], ",", 
   RowBox[{
    RowBox[{"zzz$0$3", "[", "t", "]"}], "\[Rule]", 
    SubscriptBox["z3", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "t"}]]}], ",", 
   RowBox[{
    RowBox[{"zzz$0$4", "[", "t", "]"}], "\[Rule]", 
    SubscriptBox["z4", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "t"}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.652800625471045*^9, 3.6528006972774467`*^9, {3.65280079029533*^9, 
   3.652800803535845*^9}, 3.652800901393756*^9, 3.652800965134734*^9, 
   3.6528053684754353`*^9, 3.652805399840817*^9, 3.652805727801015*^9, 
   3.6528065391414824`*^9, 3.652808110051347*^9, 3.652808167515194*^9, 
   3.652808251465045*^9, 3.6528083433338547`*^9, 3.652809478911812*^9, {
   3.6529852171716022`*^9, 3.6529852352481127`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["xtExt00"], "Input",
 CellChangeTimes->{{3.652805628760077*^9, 3.6528056323132133`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.11155197714244866`"}], "+", 
     RowBox[{"0.359845087556286`", " ", "epsVar$1"}], "+", 
     RowBox[{"0.6926315789473684`", " ", "xxxtm1Var$2"}], "+", 
     RowBox[{"0.34185283317847176`", " ", "xxxtm1Var$4"}], "-", 
     RowBox[{"0.04428506256712977`", " ", 
      RowBox[{"zzz$0$1", "[", "t", "]"}]}], "+", 
     RowBox[{"0.658`", " ", 
      RowBox[{"zzz$0$2", "[", "t", "]"}]}], "+", 
     RowBox[{"0.359845087556286`", " ", 
      RowBox[{"zzz$0$3", "[", "t", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.0579799030132484`"}], "+", 
     RowBox[{"0.18703194520402708`", " ", "epsVar$1"}], "+", 
     RowBox[{"0.36`", " ", "xxxtm1Var$2"}], "+", 
     RowBox[{"0.17768034794382573`", " ", "xxxtm1Var$4"}], "+", 
     RowBox[{"0.04428506256712977`", " ", 
      RowBox[{"zzz$0$1", "[", "t", "]"}]}], "+", 
     RowBox[{"0.342`", " ", 
      RowBox[{"zzz$0$2", "[", "t", "]"}]}], "+", 
     RowBox[{"0.18703194520402708`", " ", 
      RowBox[{"zzz$0$3", "[", "t", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.7794041020145155`", "\[VeryThinSpace]", "-", 
     RowBox[{"5.348981942634134`", " ", "xxxtm1Var$2"}], "+", 
     RowBox[{"0.342`", " ", 
      RowBox[{"zzz$0$1", "[", "t", "]"}]}], "-", 
     RowBox[{"5.081532845502427`", " ", 
      RowBox[{"zzz$0$2", "[", "t", "]"}]}], "+", 
     RowBox[{"zzz$0$4", "[", "t", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.05`", "\[VeryThinSpace]", "+", "epsVar$1", "+", 
     RowBox[{"0.95`", " ", "xxxtm1Var$4"}], "+", 
     RowBox[{"zzz$0$3", "[", "t", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.652805634035461*^9, 3.652805727829368*^9, 3.65280653917809*^9, 
   3.652808110087373*^9, 3.652809478965317*^9, {3.652985217235909*^9, 
   3.652985235272093*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["xtExt00"], "Input",
 CellChangeTimes->{3.652805921116501*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.11155197714244866`"}], "+", 
     RowBox[{"0.359845087556286`", " ", "epsVar$1"}], "+", 
     RowBox[{"0.6926315789473684`", " ", "xxxtm1Var$2"}], "+", 
     RowBox[{"0.34185283317847176`", " ", "xxxtm1Var$4"}], "-", 
     RowBox[{"0.04428506256712977`", " ", 
      RowBox[{"zzz$0$1", "[", "t", "]"}]}], "+", 
     RowBox[{"0.658`", " ", 
      RowBox[{"zzz$0$2", "[", "t", "]"}]}], "+", 
     RowBox[{"0.359845087556286`", " ", 
      RowBox[{"zzz$0$3", "[", "t", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.0579799030132484`"}], "+", 
     RowBox[{"0.18703194520402708`", " ", "epsVar$1"}], "+", 
     RowBox[{"0.36`", " ", "xxxtm1Var$2"}], "+", 
     RowBox[{"0.17768034794382573`", " ", "xxxtm1Var$4"}], "+", 
     RowBox[{"0.04428506256712977`", " ", 
      RowBox[{"zzz$0$1", "[", "t", "]"}]}], "+", 
     RowBox[{"0.342`", " ", 
      RowBox[{"zzz$0$2", "[", "t", "]"}]}], "+", 
     RowBox[{"0.18703194520402708`", " ", 
      RowBox[{"zzz$0$3", "[", "t", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.7794041020145155`", "\[VeryThinSpace]", "-", 
     RowBox[{"5.348981942634134`", " ", "xxxtm1Var$2"}], "+", 
     RowBox[{"0.342`", " ", 
      RowBox[{"zzz$0$1", "[", "t", "]"}]}], "-", 
     RowBox[{"5.081532845502427`", " ", 
      RowBox[{"zzz$0$2", "[", "t", "]"}]}], "+", 
     RowBox[{"zzz$0$4", "[", "t", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.05`", "\[VeryThinSpace]", "+", "epsVar$1", "+", 
     RowBox[{"0.95`", " ", "xxxtm1Var$4"}], "+", 
     RowBox[{"zzz$0$3", "[", "t", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.652805921922552*^9, 3.652806539229257*^9, 3.65280811013612*^9, 
   3.652809478997573*^9, {3.652985217273733*^9, 3.652985235322399*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Private`bmatExt", "//", "N"}]], "Input",
 CellChangeTimes->{{3.653050376574636*^9, 3.653050393251512*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "0.6926315789473684`", ",", "0.`", ",", 
     "0.34185283317847176`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.36`", ",", "0.`", ",", "0.17768034794382573`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "5.348981942634134`"}], ",", "0.`", ",", "0.`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.`", ",", "0.95`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.653050389119259*^9, 3.6530503943215523`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"xtExt00", "/.", "someLatexSubs"}], "]"}]], "Input",
 CellChangeTimes->{{3.652800544064843*^9, 3.652800553402185*^9}, {
  3.652800612064879*^9, 3.65280063144606*^9}}],

Cell["\<\
\\left(
\\begin{array}{c}
 0.359845 \\epsilon _t+0.692632 k_{t-1}+0.341853 \\theta _{t-1}-0.0442851
   \\text{z1}_{t-1}+0.658 \\text{z2}_{t-1}+0.359845 \\text{z3}_{t-1}-0.111552 \
\\\\
 0.187032 \\epsilon _t+0.36 k_{t-1}+0.17768 \\theta _{t-1}+0.0442851
   \\text{z1}_{t-1}+0.342 \\text{z2}_{t-1}+0.187032 \
\\text{z3}_{t-1}-0.0579799 \\\\
 -5.34898 k_{t-1}+0.342 \\text{z1}_{t-1}-5.08153
   \\text{z2}_{t-1}+\\text{z4}_{t-1}+3.7794 \\\\
 \\epsilon _t+0.95 \\theta _{t-1}+\\text{z3}_{t-1}+0.05 \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{
  3.6528005541467857`*^9, {3.652800625614255*^9, 3.652800633622295*^9}, 
   3.652800701364251*^9, {3.652800796272243*^9, 3.652800806558757*^9}, 
   3.6528009015865993`*^9, 3.652800965206586*^9, 3.652805368545361*^9, 
   3.652805399897297*^9, 3.652805727878536*^9, 3.652806539932221*^9, 
   3.652808110334762*^9, 3.652808177305863*^9, {3.652808262952351*^9, 
   3.6528082844233637`*^9}, {3.652808350294589*^9, 3.652808378120203*^9}, 
   3.652809479222643*^9, {3.6529852173446608`*^9, 3.652985235401567*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Context", "[", "genZVars", "]"}]], "Input",
 CellChangeTimes->{{3.652806709940555*^9, 3.652806719701832*^9}}],

Cell[BoxData["\<\"AMASeriesRepresentation`\"\>"], "Output",
 CellChangeTimes->{
  3.6528067209716578`*^9, 3.652808110383444*^9, 3.6528094792456207`*^9, {
   3.652985217393526*^9, 3.6529852354375134`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "[", 
  RowBox[{"xtp1Ext00", "/.", "someLatexSubs"}], "]"}]], "Input",
 CellChangeTimes->{{3.652800544064843*^9, 3.652800553402185*^9}, {
  3.652800612064879*^9, 3.65280063144606*^9}, {3.652801276287601*^9, 
  3.652801276738558*^9}}],

Cell["\<\
\\left(
\\begin{array}{c}
 0.471397 \\epsilon _t+0.249347 k_{t-1}+0.447827 \\theta _{t-1}+0.0306732
   \\text{z1}_{t-1}+0.23688 \\text{z2}_{t-1}+0.471397 \
\\text{z3}_{t-1}-0.134618 \\\\
 0.245012 \\epsilon _t+0.1296 k_{t-1}+0.232761 \\theta _{t-1}+0.0159426
   \\text{z1}_{t-1}+0.12312 \\text{z2}_{t-1}+0.245012 \
\\text{z3}_{t-1}-0.0699687 \\\\
 -1.00043 \\epsilon _t-1.92563 k_{t-1}-0.950409 \\theta _{t-1}-0.23688
   \\text{z1}_{t-1}-1.82935 \\text{z2}_{t-1}-1.00043 \\text{z3}_{t-1}+4.08954 \
\\\\
 0.95 \\epsilon _t+0.9025 \\theta _{t-1}+0.95 \\text{z3}_{t-1}+0.0975 \\\\
\\end{array}
\\right)\
\>", "Output",
 CellChangeTimes->{
  3.6528005541467857`*^9, {3.652800625614255*^9, 3.652800633622295*^9}, 
   3.652800701364251*^9, {3.652800796272243*^9, 3.652800806558757*^9}, 
   3.6528009015865993`*^9, 3.652800965206586*^9, 3.652801277754541*^9, 
   3.6528053685981903`*^9, 3.652805399950138*^9, 3.652805727922475*^9, 
   3.652806540135795*^9, 3.652808110432929*^9, 3.65280836463805*^9, 
   3.652809479296763*^9, {3.6529852174443398`*^9, 3.652985235487876*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "00", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"solnSubsExt00", "=", 
     RowBox[{"Private`makeConstraintFindRootFunc", "[", 
      RowBox[{"Private`hFuncExt", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Private`bmatExt", "//", "N"}], ",", 
         RowBox[{"Private`phimatExt", "//", "N"}], ",", 
         RowBox[{"Private`fmatExt", "//", "N"}], ",", 
         RowBox[{"Private`psiepsExt", "//", "N"}], ",", 
         RowBox[{"Private`psicExt", "//", "N"}], ",", 
         RowBox[{"Private`psizExt", "//", "N"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solnFuncsExt00", "=", 
     RowBox[{"Private`subsFuncToVecFunc", "[", "solnSubsExt00", "]"}]}], 
    ";"}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.652633326648918*^9, 3.6526333266498947`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"anEpsVal", "=", "0.05"}], ";", 
  RowBox[{"aThVal", "=", "1"}], ";", 
  RowBox[{"kNow", "=", "kVal"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"someSubs", "=", 
   RowBox[{"solnSubsExt00", "[", 
    RowBox[{".1", ",", "kNow", ",", "10", ",", "aThVal", ",", "anEpsVal"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"eqnSubs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"kk", "[", 
         RowBox[{"t", "-", "1"}], "]"}], "\[Rule]", "kNow"}], ",", 
       RowBox[{
        RowBox[{"theta", "[", 
         RowBox[{"t", "-", "1"}], "]"}], "\[Rule]", "aThVal"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"eps", "[", "theta", "]"}], "[", "t", "]"}], "\[Rule]", 
        "anEpsVal"}]}], "}"}], ",", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cc", "[", "t", "]"}], ",", 
         RowBox[{"kk", "[", "t", "]"}], ",", 
         RowBox[{"ratioThetaToC", "[", "t", "]"}], ",", 
         RowBox[{"theta", "[", "t", "]"}], ",", 
         RowBox[{"cc", "[", 
          RowBox[{"t", "+", "1"}], "]"}], ",", 
         RowBox[{"kk", "[", 
          RowBox[{"t", "+", "1"}], "]"}], ",", 
         RowBox[{"ratioThetaToC", "[", 
          RowBox[{"t", "+", "1"}], "]"}], ",", 
         RowBox[{"theta", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], "}"}], "->", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xtExt00", ",", "xtp1Ext00"}], "}"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xxxtm1Var$2", "\[Rule]", "kVal"}], ",", 
            RowBox[{"xxxtm1Var$4", "\[Rule]", "aThVal"}], ",", 
            RowBox[{"epsVar$1", "\[Rule]", "anEpsVal"}]}], "}"}]}], "/.", 
         "someSubs"}], "]"}]}], "]"}]}], "]"}]}], "\n", 
  "\n"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.652633341251429*^9, 3.652633403509242*^9}, {
  3.652633698371526*^9, 3.652633734185979*^9}, {3.652633797755373*^9, 
  3.65263384687427*^9}, {3.6526344162765703`*^9, 3.65263442574684*^9}, {
  3.652720333020479*^9, 3.652720356841071*^9}, {3.6527204869990788`*^9, 
  3.652720618397881*^9}, {3.652720673367258*^9, 3.6527206841415863`*^9}, {
  3.652720719136127*^9, 3.65272082297128*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"kk", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "t"}], "]"}], "\[Rule]", 
    "0.18703194520402708`"}], ",", 
   RowBox[{
    RowBox[{"theta", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "t"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"eps", "[", "theta", "]"}], "[", "t", "]"}], "\[Rule]", 
    "0.05`"}], ",", 
   RowBox[{
    RowBox[{"cc", "[", "t", "]"}], "\[Rule]", 
    RowBox[{"0.37783734193410035`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.04428506256712977`", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "0.0018101810335106247`"}], ")"}], "[", "t", "]"}]}], 
     "+", 
     RowBox[{"0.658`", " ", 
      RowBox[{"0", "[", "t", "]"}]}], "+", 
     RowBox[{"0.359845087556286`", " ", 
      RowBox[{"0.0012710963760241556`", "[", "t", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"kk", "[", "t", "]"}], "\[Rule]", 
    RowBox[{"0.19638354246422843`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.04428506256712977`", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "0.0018101810335106247`"}], ")"}], "[", "t", "]"}]}], 
     "+", 
     RowBox[{"0.342`", " ", 
      RowBox[{"0", "[", "t", "]"}]}], "+", 
     RowBox[{"0.18703194520402708`", " ", 
      RowBox[{"0.0012710963760241556`", "[", "t", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"ratioThetaToC", "[", "t", "]"}], "\[Rule]", 
    RowBox[{"2.778973604422438`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.342`", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "0.0018101810335106247`"}], ")"}], "[", "t", "]"}]}], 
     "-", 
     RowBox[{"5.081532845502427`", " ", 
      RowBox[{"0", "[", "t", "]"}]}], "+", 
     RowBox[{"0.000030317745502462342`", "[", "t", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"theta", "[", "t", "]"}], "\[Rule]", 
    RowBox[{"1.05`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.0012710963760241556`", "[", "t", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"cc", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", 
    RowBox[{"0.38341494079122285`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.03067323280965409`", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "0.0018101810335106247`"}], ")"}], "[", "t", "]"}]}], 
     "+", 
     RowBox[{"0.23688`", " ", 
      RowBox[{"0", "[", "t", "]"}]}], "+", 
     RowBox[{"0.4713970646987347`", " ", 
      RowBox[{"0.0012710963760241556`", "[", "t", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"kk", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", 
    RowBox[{"0.19928253761489081`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.015942622524166717`", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "0.0018101810335106247`"}], ")"}], "[", "t", "]"}]}], 
     "+", 
     RowBox[{"0.12312000000000001`", " ", 
      RowBox[{"0", "[", "t", "]"}]}], "+", 
     RowBox[{"0.24501184821727548`", " ", 
      RowBox[{"0.0012710963760241556`", "[", "t", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"ratioThetaToC", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", 
    RowBox[{"2.7289520795428337`", "\[VeryThinSpace]", "-", 
     RowBox[{"0.23687999999999992`", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "0.0018101810335106247`"}], ")"}], "[", "t", "]"}]}], 
     "-", 
     RowBox[{"1.8293518243808737`", " ", 
      RowBox[{"0", "[", "t", "]"}]}], "-", 
     RowBox[{"1.0004304975920777`", " ", 
      RowBox[{"0.0012710963760241556`", "[", "t", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", 
    RowBox[{"1.0474999999999999`", "\[VeryThinSpace]", "+", 
     RowBox[{"0.95`", " ", 
      RowBox[{"0.0012710963760241556`", "[", "t", "]"}]}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.652720619561987*^9, 3.652720696840035*^9, 3.652720823531247*^9, 
   3.652781032228959*^9, 3.652805368686966*^9, 3.652805400006255*^9, 
   3.652805728001445*^9, 3.652806540208816*^9, 3.6528081110183353`*^9, 
   3.652808436853601*^9, 3.652809141033132*^9, 3.65280926635266*^9, 
   3.652809479542748*^9, 3.652809515118854*^9, {3.6529852175192127`*^9, 
   3.6529852355731297`*^9}}]
}, Open  ]],

Cell["substuting into equation satisfies the non linear system", "Text",
 CellChangeTimes->{{3.652722611594398*^9, 3.652722627045945*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"Private`rbcEqnsExt", "//.", "Private`tog"}], ")"}], "/.", 
  "eqnSubs"}]], "Input",
 CellChangeTimes->{{3.6527203791798143`*^9, 3.6527203941894903`*^9}, {
  3.652720435358019*^9, 3.652720451548257*^9}, {3.652720629619636*^9, 
  3.652720653791709*^9}, {3.652720690939259*^9, 3.652720692726694*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"171", " ", 
         RowBox[{"(", 
          RowBox[{"2.7289520795428337`", "\[VeryThinSpace]", "-", 
           RowBox[{"0.23687999999999992`", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"-", "0.0018101810335106247`"}], ")"}], "[", "t", 
             "]"}]}], "-", 
           RowBox[{"1.8293518243808737`", " ", 
            RowBox[{"0", "[", "t", "]"}]}], "-", 
           RowBox[{"1.0004304975920777`", " ", 
            RowBox[{"0.0012710963760241556`", "[", "t", "]"}]}]}], ")"}]}], 
        ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"500", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"0.19638354246422843`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.04428506256712977`", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"-", "0.0018101810335106247`"}], ")"}], "[", "t", 
              "]"}]}], "+", 
            RowBox[{"0.342`", " ", 
             RowBox[{"0", "[", "t", "]"}]}], "+", 
            RowBox[{"0.18703194520402708`", " ", 
             RowBox[{"0.0012710963760241556`", "[", "t", "]"}]}]}], ")"}], 
          RowBox[{"16", "/", "25"}]]}], ")"}]}], ")"}]}], "+", 
    FractionBox["1", 
     RowBox[{"0.37783734193410035`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.04428506256712977`", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "0.0018101810335106247`"}], ")"}], "[", "t", "]"}]}], 
      "+", 
      RowBox[{"0.658`", " ", 
       RowBox[{"0", "[", "t", "]"}]}], "+", 
      RowBox[{"0.359845087556286`", " ", 
       RowBox[{"0.0012710963760241556`", "[", "t", "]"}]}]}]]}], ",", 
   RowBox[{"0.5742208843983287`", "\[VeryThinSpace]", "+", 
    RowBox[{"1.`", " ", 
     RowBox[{"0", "[", "t", "]"}]}], "+", 
    RowBox[{"0.5468770327603131`", " ", 
     RowBox[{"0.0012710963760241556`", "[", "t", "]"}]}], "-", 
    RowBox[{"0.5468770327603131`", " ", 
     RowBox[{"(", 
      RowBox[{"1.05`", "\[VeryThinSpace]", "+", 
       RowBox[{"0.0012710963760241556`", "[", "t", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", "0.0012710963760240723`"}], "+", 
    RowBox[{"0.0012710963760241556`", "[", "t", "]"}]}], ",", 
   RowBox[{"2.778973604422438`", "\[VeryThinSpace]", "+", 
    RowBox[{"0.342`", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"-", "0.0018101810335106247`"}], ")"}], "[", "t", "]"}]}], "-", 
    RowBox[{"5.081532845502427`", " ", 
     RowBox[{"0", "[", "t", "]"}]}], "+", 
    RowBox[{"0.000030317745502462342`", "[", "t", "]"}], "-", 
    FractionBox[
     RowBox[{"1.05`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.0012710963760241556`", "[", "t", "]"}]}], 
     RowBox[{"0.37783734193410035`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.04428506256712977`", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"-", "0.0018101810335106247`"}], ")"}], "[", "t", "]"}]}], 
      "+", 
      RowBox[{"0.658`", " ", 
       RowBox[{"0", "[", "t", "]"}]}], "+", 
      RowBox[{"0.359845087556286`", " ", 
       RowBox[{"0.0012710963760241556`", "[", "t", "]"}]}]}]]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.652720441182235*^9, 3.65272045263652*^9}, {
   3.6527206342841377`*^9, 3.652720654657296*^9}, 3.652720696960671*^9, 
   3.652720830659266*^9, 3.6527810322664948`*^9, 3.6528053687332563`*^9, 
   3.652805400056139*^9, 3.652805728038262*^9, 3.652806540245384*^9, 
   3.652808111312786*^9, 3.65280947957644*^9, {3.652985217569974*^9, 
   3.652985235604847*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Get", "[", 
  "\"\</Users/garyanderson/git/AMASeriesRepresentation/\
AMASeriesRepresentation/AMASeriesRepresentation.m\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.6527217685317087`*^9, 3.652721790482761*^9}, {
  3.6527811945409327`*^9, 3.652781196540784*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"reading AMASeriesRepresentation`\"\>"], "Print",
 CellChangeTimes->{
  3.6527217937801237`*^9, 3.652781032298655*^9, 3.6528053687837687`*^9, 
   3.652805400107087*^9, 3.652805728088018*^9, 3.652806540296501*^9, 
   3.652808111343061*^9, 3.652809479612905*^9, {3.6529852176211853`*^9, 
   3.652985235638001*^9}}],

Cell[BoxData["\<\"changing MatrixPower to produce Identity Matrix for \
singular matrices raised to 0th power\"\>"], "Print",
 CellChangeTimes->{
  3.6527217937801237`*^9, 3.652781032298655*^9, 3.6528053687837687`*^9, 
   3.652805400107087*^9, 3.652805728088018*^9, 3.652806540296501*^9, 
   3.652808111343061*^9, 3.652809479612905*^9, {3.6529852176211853`*^9, 
   3.652985235644875*^9}}],

Cell[BoxData["\<\"should memoize subXtXtp1\"\>"], "Print",
 CellChangeTimes->{
  3.6527217937801237`*^9, 3.652781032298655*^9, 3.6528053687837687`*^9, 
   3.652805400107087*^9, 3.652805728088018*^9, 3.652806540296501*^9, 
   3.652808111343061*^9, 3.652809479612905*^9, {3.6529852176211853`*^9, 
   3.652985235655325*^9}}],

Cell[BoxData["\<\"should memoize subXtXtp1\"\>"], "Print",
 CellChangeTimes->{
  3.6527217937801237`*^9, 3.652781032298655*^9, 3.6528053687837687`*^9, 
   3.652805400107087*^9, 3.652805728088018*^9, 3.652806540296501*^9, 
   3.652808111343061*^9, 3.652809479612905*^9, {3.6529852176211853`*^9, 
   3.652985235666335*^9}}],

Cell[BoxData["\<\"done reading AMASeriesRepresentation`\"\>"], "Print",
 CellChangeTimes->{
  3.6527217937801237`*^9, 3.652781032298655*^9, 3.6528053687837687`*^9, 
   3.652805400107087*^9, 3.652805728088018*^9, 3.652806540296501*^9, 
   3.652808111343061*^9, 3.652809479612905*^9, {3.6529852176211853`*^9, 
   3.652985235677136*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Identity", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Private`bmatExt", "//", "N"}], ",", 
    RowBox[{"Private`phimatExt", "//", "N"}], ",", 
    RowBox[{"Private`fmatExt", "//", "N"}], ",", 
    RowBox[{"Private`psiepsExt", "//", "N"}], ",", 
    RowBox[{"Private`psicExt", "//", "N"}], ",", 
    RowBox[{"Private`psizExt", "//", "N"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6527221813231363`*^9, 3.652722189513432*^9}, {
  3.652722288751897*^9, 3.652722295816292*^9}, {3.652722426578147*^9, 
  3.652722431494051*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.`", ",", "0.6926315789473684`", ",", "0.`", ",", 
       "0.34185283317847176`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.36`", ",", "0.`", ",", "0.17768034794382573`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", 
       RowBox[{"-", "5.348981942634134`"}], ",", "0.`", ",", "0.`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`", ",", "0.`", ",", "0.95`"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.04428506256712977`"}], ",", "0.658`", ",", 
       "0.359845087556286`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.04428506256712977`", ",", "0.342`", ",", "0.18703194520402708`", ",",
        "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.342`", ",", 
       RowBox[{"-", "5.081532845502427`"}], ",", "0.`", ",", "1.`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`", ",", "1.`", ",", "0.`"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`", ",", 
       RowBox[{"-", "0.04428506256712977`"}], ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`", ",", "0.04428506256712977`", ",", "0.`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`", ",", "0.342`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0.`", "}"}], ",", 
     RowBox[{"{", "0.`", "}"}], ",", 
     RowBox[{"{", "1.`", "}"}], ",", 
     RowBox[{"{", "0.`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"-", "3.7794041020145155`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"-", "0.19687573179371273`"}], "}"}], ",", 
     RowBox[{"{", "0.05`", "}"}], ",", 
     RowBox[{"{", "2.778973604422438`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.`", ",", "0.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "1.`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`", ",", "1.`", ",", "0.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`", ",", "0.`", ",", "1.`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6527221737486763`*^9, 3.652722190211795*^9}, 
   3.6527222965411777`*^9, 3.6527224328305607`*^9, 3.65278103236623*^9, 
   3.6528053688652287`*^9, 3.652805400207534*^9, 3.652805728171781*^9, 
   3.652806540378687*^9, 3.652808111410529*^9, 3.652809479858427*^9, {
   3.65298521770256*^9, 3.652985235722513*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["two time periods", "Section",
 CellChangeTimes->{{3.652721356923748*^9, 3.652721360660366*^9}, {
  3.652721409026531*^9, 3.652721414002672*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Trace", "[", 
   RowBox[{
    RowBox[{"xtExt01", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Private`computeNextXt", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "Private`bmatExt", ",", "Private`phimatExt", ",", 
            "Private`fmatExt", ",", "Private`psiepsExt", ",", 
            "Private`psicExt", ",", "Private`psizExt"}], "}"}], ",", "1"}], 
         "]"}], "//", "N"}], "//", "Expand"}], "//", "Simplify"}]}], ",", 
    RowBox[{"genZVars", "[", "___", "]"}], ",", 
    RowBox[{"TraceForward", "\[Rule]", "True"}]}], "]"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xtp1Ext01", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Private`computeNextXtp1", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "Private`bmatExt", ",", "Private`phimatExt", ",", "Private`fmatExt", 
          ",", "Private`psiepsExt", ",", "Private`psicExt", ",", 
          "Private`psizExt"}], "}"}], ",", "1"}], "]"}], "//", "N"}], "//", 
     "Expand"}], "//", "Simplify"}]}], ";"}], "\n"}], "Input",
 CellChangeTimes->{{3.652633138097465*^9, 3.6526331597756767`*^9}, {
  3.6527214183414803`*^9, 3.652721421861356*^9}, {3.652721800030704*^9, 
  3.6527218082439117`*^9}, {3.65272272296519*^9, 3.652722724650775*^9}, {
  3.6527227692690353`*^9, 3.652722769716811*^9}, {3.652802397559352*^9, 
  3.652802423603973*^9}, {3.652811548244067*^9, 3.652811568984538*^9}, {
  3.652811644656871*^9, 3.652811672112033*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"genZVars", "[", 
               RowBox[{"1", ",", "4"}], "]"}],
              HoldForm], ",", 
             TagBox[
              RowBox[{"genZVars", "[", 
               RowBox[{"1", ",", "4", ",", "0"}], "]"}],
              HoldForm], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"zzz$0$4", "[", "t", "]"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"zzz$0$3", "[", "t", "]"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"zzz$0$2", "[", "t", "]"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"zzz$0$1", "[", "t", "]"}], "}"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"zzz$1$4", "[", "t", "]"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"zzz$1$3", "[", "t", "]"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"zzz$1$2", "[", "t", "]"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"zzz$1$1", "[", "t", "]"}], "}"}]}], "}"}]}], "}"}],
              HoldForm]}], "}"}], "}"}], "}"}], "}"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          TagBox[
           RowBox[{"genZVars", "[", "4", "]"}],
           HoldForm], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             TagBox[
              RowBox[{"genZVars", "[", 
               RowBox[{"0", ",", "4"}], "]"}],
              HoldForm], ",", 
             TagBox[
              RowBox[{"genZVars", "[", 
               RowBox[{"0", ",", "4", ",", "0"}], "]"}],
              HoldForm], ",", 
             TagBox[
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"zzz$0$4", "[", "t", "]"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"zzz$0$3", "[", "t", "]"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"zzz$0$2", "[", "t", "]"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"zzz$0$1", "[", "t", "]"}], "}"}]}], "}"}], "}"}],
              HoldForm]}], "}"}], "}"}], ",", 
          TagBox[
           RowBox[{"{", 
            RowBox[{
             RowBox[{"zzz$0$1", "[", "t", "]"}], ",", 
             RowBox[{"zzz$0$2", "[", "t", "]"}], ",", 
             RowBox[{"zzz$0$3", "[", "t", "]"}], ",", 
             RowBox[{"zzz$0$4", "[", "t", "]"}]}], "}"}],
           HoldForm]}], "}"}], "}"}]}], "}"}], "}"}], "}"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.65281167323783*^9, 3.652812050576366*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"??", "genZVars"}]], "Input",
 CellChangeTimes->{{3.652811711373941*^9, 3.652811714997837*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"genZVars[horizons_Integer,numConstr_Integer,offset_Integer]\"\>\
", "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.652812079570343*^9},
 CellTags->"Info-40948772-cfc9-4368-9d68-33757ef5873a"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{"genZVars", "[", 
          RowBox[{"0", ",", "4", ",", "0"}], "]"}], "=", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"zzz$0$4", "[", "t", "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"zzz$0$3", "[", "t", "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"zzz$0$2", "[", "t", "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"zzz$0$1", "[", "t", "]"}], "}"}]}], "}"}], "}"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"genZVars", "[", 
          RowBox[{"1", ",", "4", ",", "0"}], "]"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zzz$0$4", "[", "t", "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zzz$0$3", "[", "t", "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zzz$0$2", "[", "t", "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zzz$0$1", "[", "t", "]"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"zzz$1$4", "[", "t", "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zzz$1$3", "[", "t", "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zzz$1$2", "[", "t", "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"zzz$1$1", "[", "t", "]"}], "}"}]}], "}"}]}], "}"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"genZVars", "[", "Private`numConstr_Integer", "]"}], ":=", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{"genZVars", "[", 
             RowBox[{"0", ",", "Private`numConstr"}], "]"}], "]"}], "]"}], "/;", 
          RowBox[{"And", "[", 
           RowBox[{"Private`numConstr", "\[GreaterEqual]", "0"}], "]"}]}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"genZVars", "[", 
          RowBox[{
          "Private`horizons_Integer", ",", "Private`numConstr_Integer"}], 
          "]"}], ":=", 
         RowBox[{"genZVars", "[", 
          RowBox[{"Private`horizons", ",", "Private`numConstr", ",", "0"}], 
          "]"}]}]},
       {" "},
       {
        RowBox[{
         RowBox[{"genZVars", "[", 
          RowBox[{
          "Private`horizons_Integer", ",", "Private`numConstr_Integer", ",", 
           "Private`offset_Integer"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{
             RowBox[{"genZVars", "[", 
              RowBox[{
              "Private`horizons", ",", "Private`numConstr", ",", 
               "Private`offset"}], "]"}], "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"makeProtectedSymbol", "[", 
                  RowBox[{"\<\"zzz$\"\>", "<>", 
                   RowBox[{"ToString", "[", "Private`forTime", "]"}], 
                   "<>", "\<\"$\"\>", "<>", 
                   RowBox[{"ToString", "[", "Private`ii", "]"}]}], "]"}], "[",
                  "t", "]"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Private`forTime", ",", 
                 RowBox[{"0", "-", "Private`offset"}], ",", 
                 "Private`horizons"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Private`ii", ",", "Private`numConstr", ",", "1", ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "]"}]}]}], "]"}], "/;", 
          RowBox[{"Private`offset", "\[LessEqual]", "0"}]}]}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[AMASeriesRepresentation`genZVars],
  Editable->False]], "Print",
 CellChangeTimes->{3.6528120796001883`*^9},
 CellTags->"Info-40948772-cfc9-4368-9d68-33757ef5873a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["xtExt01"], "Input",
 CellChangeTimes->{{3.6528115967080193`*^9, 3.652811601686305*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.11155197714244866`"}], "+", 
     RowBox[{"0.359845087556286`", " ", "epsVar$1"}], "+", 
     RowBox[{"0.6926315789473684`", " ", "xxxtm1Var$2"}], "+", 
     RowBox[{"0.34185283317847176`", " ", "xxxtm1Var$4"}], "-", 
     RowBox[{"0.04428506256712977`", " ", 
      RowBox[{"zzz$0$1", "[", "t", "]"}]}], "+", 
     RowBox[{"0.658`", " ", 
      RowBox[{"zzz$0$2", "[", "t", "]"}]}], "+", 
     RowBox[{"0.359845087556286`", " ", 
      RowBox[{"zzz$0$3", "[", "t", "]"}]}], "-", 
     RowBox[{"0.04428506256712977`", " ", 
      RowBox[{"zzz$1$1", "[", "t", "]"}]}], "+", 
     RowBox[{"0.225036`", " ", 
      RowBox[{"zzz$1$3", "[", "t", "]"}]}], "-", 
     RowBox[{"0.01514549139795838`", " ", 
      RowBox[{"zzz$1$4", "[", "t", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.0579799030132484`"}], "+", 
     RowBox[{"0.18703194520402708`", " ", "epsVar$1"}], "+", 
     RowBox[{"0.36`", " ", "xxxtm1Var$2"}], "+", 
     RowBox[{"0.17768034794382573`", " ", "xxxtm1Var$4"}], "+", 
     RowBox[{"0.04428506256712977`", " ", 
      RowBox[{"zzz$0$1", "[", "t", "]"}]}], "+", 
     RowBox[{"0.342`", " ", 
      RowBox[{"zzz$0$2", "[", "t", "]"}]}], "+", 
     RowBox[{"0.18703194520402708`", " ", 
      RowBox[{"zzz$0$3", "[", "t", "]"}]}], "+", 
     RowBox[{"0.04428506256712977`", " ", 
      RowBox[{"zzz$1$1", "[", "t", "]"}]}], "-", 
     RowBox[{"0.225036`", " ", 
      RowBox[{"zzz$1$3", "[", "t", "]"}]}], "+", 
     RowBox[{"0.01514549139795838`", " ", 
      RowBox[{"zzz$1$4", "[", "t", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.7794041020145155`", "\[VeryThinSpace]", "-", 
     RowBox[{"5.348981942634134`", " ", "xxxtm1Var$2"}], "+", 
     RowBox[{"0.342`", " ", 
      RowBox[{"zzz$0$1", "[", "t", "]"}]}], "-", 
     RowBox[{"5.081532845502427`", " ", 
      RowBox[{"zzz$0$2", "[", "t", "]"}]}], "+", 
     RowBox[{"zzz$0$4", "[", "t", "]"}], "+", 
     RowBox[{"0.342`", " ", 
      RowBox[{"zzz$1$1", "[", "t", "]"}]}], "-", 
     RowBox[{"1.7378842331618303`", " ", 
      RowBox[{"zzz$1$3", "[", "t", "]"}]}], "+", 
     RowBox[{"0.116964`", " ", 
      RowBox[{"zzz$1$4", "[", "t", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.05`", "\[VeryThinSpace]", "+", "epsVar$1", "+", 
     RowBox[{"0.95`", " ", "xxxtm1Var$4"}], "+", 
     RowBox[{"zzz$0$3", "[", "t", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.65281160258899*^9, 3.6528121031851273`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Private`phimatExt", " ", ".", " ", "Private`fmatExt"}], "//", 
   "N"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.652812404051132*^9, 3.652812446362956*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.15416775787999581`", ",", "0.`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.07714924989116106`", ",", "0.`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", 
     RowBox[{"-", "0.24018149139795839`"}], ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.`", ",", "0.342`", ",", "0.`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.652812439173976*^9, 3.652812448249969*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "00", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"solnSubsExt00", "=", 
     RowBox[{"Private`makeConstraintFindRootFunc", "[", 
      RowBox[{"Private`hFuncExt", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Private`bmatExt", "//", "N"}], ",", 
         RowBox[{"Private`phimatExt", "//", "N"}], ",", 
         RowBox[{"Private`fmatExt", "//", "N"}], ",", 
         RowBox[{"Private`psiepsExt", "//", "N"}], ",", 
         RowBox[{"Private`psicExt", "//", "N"}], ",", 
         RowBox[{"Private`psizExt", "//", "N"}]}], "}"}], ",", 
       RowBox[{"{", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"solnFuncsExt00", "=", 
     RowBox[{"Private`subsFuncToVecFunc", "[", "solnSubsExt00", "]"}]}], 
    ";"}], "\n"}]}]], "Input",
 CellChangeTimes->{{3.652633326648918*^9, 3.6526333266498947`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"anEpsVal", "=", "0.05"}], ";", 
  RowBox[{"aThVal", "=", "1"}], ";", 
  RowBox[{"kNow", "=", "kVal"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"someSubs", "=", 
   RowBox[{"solnSubsExt00", "[", 
    RowBox[{".1", ",", "kNow", ",", "10", ",", "aThVal", ",", "anEpsVal"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"eqnSubs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"kk", "[", 
         RowBox[{"t", "-", "1"}], "]"}], "\[Rule]", "kNow"}], ",", 
       RowBox[{
        RowBox[{"theta", "[", 
         RowBox[{"t", "-", "1"}], "]"}], "\[Rule]", "aThVal"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"eps", "[", "theta", "]"}], "[", "t", "]"}], "\[Rule]", 
        "anEpsVal"}]}], "}"}], ",", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cc", "[", "t", "]"}], ",", 
         RowBox[{"kk", "[", "t", "]"}], ",", 
         RowBox[{"ratioThetaToC", "[", "t", "]"}], ",", 
         RowBox[{"theta", "[", "t", "]"}], ",", 
         RowBox[{"cc", "[", 
          RowBox[{"t", "+", "1"}], "]"}], ",", 
         RowBox[{"kk", "[", 
          RowBox[{"t", "+", "1"}], "]"}], ",", 
         RowBox[{"ratioThetaToC", "[", 
          RowBox[{"t", "+", "1"}], "]"}], ",", 
         RowBox[{"theta", "[", 
          RowBox[{"t", "+", "1"}], "]"}]}], "}"}], "->", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"xtExt00", ",", "xtp1Ext00"}], "}"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xxxtm1Var$2", "\[Rule]", "kVal"}], ",", 
            RowBox[{"xxxtm1Var$4", "\[Rule]", "aThVal"}], ",", 
            RowBox[{"epsVar$1", "\[Rule]", "anEpsVal"}]}], "}"}]}], "/.", 
         "someSubs"}], "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\n"}], "\n"}], "Input",
 CellChangeTimes->{{3.652633341251429*^9, 3.652633403509242*^9}, {
  3.652633698371526*^9, 3.652633734185979*^9}, {3.652633797755373*^9, 
  3.65263384687427*^9}, {3.6526344162765703`*^9, 3.65263442574684*^9}, {
  3.652720333020479*^9, 3.652720356841071*^9}, {3.6527204869990788`*^9, 
  3.652720618397881*^9}, {3.652720673367258*^9, 3.6527206841415863`*^9}, {
  3.652720719136127*^9, 3.65272082297128*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"kk", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "t"}], "]"}], "\[Rule]", 
    "0.18703194520402708`"}], ",", 
   RowBox[{
    RowBox[{"theta", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "t"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"eps", "[", "theta", "]"}], "[", "t", "]"}], "\[Rule]", 
    "0.05`"}], ",", 
   RowBox[{
    RowBox[{"cc", "[", "t", "]"}], "\[Rule]", "0.37837490370115007`"}], ",", 
   RowBox[{
    RowBox[{"kk", "[", "t", "]"}], "\[Rule]", "0.19654111411165118`"}], ",", 
   RowBox[{
    RowBox[{"ratioThetaToC", "[", "t", "]"}], "\[Rule]", 
    "2.7783848402544797`"}], ",", 
   RowBox[{
    RowBox[{"theta", "[", "t", "]"}], "\[Rule]", "1.0512710963760241`"}], ",", 
   RowBox[{
    RowBox[{"cc", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", "0.3839586077875613`"}], ",", 
   RowBox[{
    RowBox[{"kk", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", "0.1995651122543251`"}], ",", 
   RowBox[{
    RowBox[{"ratioThetaToC", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", "2.728109231646098`"}], ",", 
   RowBox[{
    RowBox[{"theta", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", "1.048707541557223`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.652781041325575*^9, 3.652805369000504*^9, 
  3.652805400341751*^9, 3.652805728305838*^9, 3.652806540542375*^9, 
  3.652809479978341*^9, 3.652809524340362*^9, 3.652811576001713*^9}]
}, Open  ]],

Cell["substuting into equation satisfies the non linear system", "Text",
 CellChangeTimes->{{3.652722611594398*^9, 3.652722627045945*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"kk", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "t"}], "]"}], "\[Rule]", 
    "0.18703194520402708`"}], ",", 
   RowBox[{
    RowBox[{"theta", "[", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "t"}], "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"eps", "[", "theta", "]"}], "[", "t", "]"}], "\[Rule]", 
    "0.05`"}], ",", 
   RowBox[{
    RowBox[{"cc", "[", "t", "]"}], "\[Rule]", "0.37837490370115007`"}], ",", 
   RowBox[{
    RowBox[{"kk", "[", "t", "]"}], "\[Rule]", "0.19654111411165118`"}], ",", 
   RowBox[{
    RowBox[{"ratioThetaToC", "[", "t", "]"}], "\[Rule]", 
    "2.7783848402544797`"}], ",", 
   RowBox[{
    RowBox[{"theta", "[", "t", "]"}], "\[Rule]", "1.0512710963760241`"}], ",", 
   RowBox[{
    RowBox[{"cc", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", "0.3839586077875613`"}], ",", 
   RowBox[{
    RowBox[{"kk", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", "0.1995651122543251`"}], ",", 
   RowBox[{
    RowBox[{"ratioThetaToC", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", "2.728109231646098`"}], ",", 
   RowBox[{
    RowBox[{"theta", "[", 
     RowBox[{"1", "+", "t"}], "]"}], "\[Rule]", "1.048707541557223`"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.652720619561987*^9, 3.652720696840035*^9, 
  3.652720823531247*^9, 3.652721811503248*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"Private`rbcEqnsExt", "//.", "Private`tog"}], ")"}], "/.", 
  "eqnSubs"}]], "Input",
 CellChangeTimes->{{3.6527203791798143`*^9, 3.6527203941894903`*^9}, {
  3.652720435358019*^9, 3.652720451548257*^9}, {3.652720629619636*^9, 
  3.652720653791709*^9}, {3.652720690939259*^9, 3.652720692726694*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.3322676295501878`*^-15", ",", "0.`", ",", "0.`", ",", 
   RowBox[{"-", "4.440892098500626`*^-16"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.652720441182235*^9, 3.65272045263652*^9}, {
   3.6527206342841377`*^9, 3.652720654657296*^9}, 3.652720696960671*^9, 
   3.652720830659266*^9, 3.6527218115451736`*^9, 3.652781041364936*^9, 
   3.652805369050455*^9, 3.652805400392116*^9, 3.65280572835599*^9, 
   3.652806540578017*^9, 3.6528094800032177`*^9, 3.652809524360437*^9, 
   3.65281157603294*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{783, 873},
WindowMargins->{{Automatic, 195}, {Automatic, 0}},
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 29, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info-6582d735-f446-442d-a9a0-ce139752c70e"->{
  Cell[4232, 109, 226, 4, 43, "Print",
   CellTags->"Info-6582d735-f446-442d-a9a0-ce139752c70e"],
  Cell[4461, 115, 2905, 73, 186, "Print",
   CellTags->"Info-6582d735-f446-442d-a9a0-ce139752c70e"]},
 "Info-40948772-cfc9-4368-9d68-33757ef5873a"->{
  Cell[58496, 1461, 226, 4, 43, "Print",
   CellTags->"Info-40948772-cfc9-4368-9d68-33757ef5873a"],
  Cell[58725, 1467, 4483, 116, 269, "Print",
   CellTags->"Info-40948772-cfc9-4368-9d68-33757ef5873a"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info-6582d735-f446-442d-a9a0-ce139752c70e", 74316, 1888},
 {"Info-40948772-cfc9-4368-9d68-33757ef5873a", 74564, 1893}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 132, 2, 92, "Title"],
Cell[CellGroupData[{
Cell[737, 28, 815, 16, 97, "Input"],
Cell[CellGroupData[{
Cell[1577, 48, 193, 2, 22, "Print"],
Cell[1773, 52, 190, 2, 22, "Print"],
Cell[1966, 56, 195, 2, 22, "Print"],
Cell[2164, 60, 200, 2, 22, "Print"],
Cell[2367, 64, 192, 2, 22, "Print"],
Cell[2562, 68, 191, 2, 21, "Print"],
Cell[2756, 72, 196, 2, 22, "Print"],
Cell[2955, 76, 223, 3, 22, "Print"],
Cell[3181, 81, 220, 3, 22, "Print"],
Cell[3404, 86, 223, 3, 22, "Print"],
Cell[3630, 91, 207, 2, 22, "Print"],
Cell[3840, 95, 198, 2, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4087, 103, 120, 2, 28, "Input"],
Cell[CellGroupData[{
Cell[4232, 109, 226, 4, 43, "Print",
 CellTags->"Info-6582d735-f446-442d-a9a0-ce139752c70e"],
Cell[4461, 115, 2905, 73, 186, "Print",
 CellTags->"Info-6582d735-f446-442d-a9a0-ce139752c70e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7415, 194, 146, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[7586, 199, 143, 2, 28, "Input"],
Cell[CellGroupData[{
Cell[7754, 205, 263, 3, 22, "Print"],
Cell[8020, 210, 250, 3, 21, "Print"],
Cell[8273, 215, 230, 3, 21, "Print"],
Cell[8506, 220, 228, 3, 21, "Print"],
Cell[8737, 225, 230, 3, 21, "Print"],
Cell[8970, 230, 230, 3, 21, "Print"],
Cell[9203, 235, 230, 3, 21, "Print"],
Cell[9436, 240, 249, 3, 21, "Print"],
Cell[9688, 245, 250, 3, 21, "Print"],
Cell[9941, 250, 230, 3, 21, "Print"],
Cell[10174, 255, 230, 3, 21, "Print"],
Cell[10407, 260, 230, 3, 21, "Print"],
Cell[10640, 265, 230, 3, 21, "Print"],
Cell[10873, 270, 232, 3, 21, "Print"],
Cell[11108, 275, 251, 3, 21, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11420, 285, 106, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[11551, 290, 225, 5, 28, "Input"],
Cell[11779, 297, 275, 4, 22, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12091, 306, 153, 2, 28, "Input"],
Cell[12247, 310, 298, 4, 22, "Print"],
Cell[12548, 316, 1601, 27, 93, "Message"],
Cell[14152, 345, 1162, 19, 107, "Message"],
Cell[15317, 366, 1421, 23, 131, "Message"],
Cell[16741, 391, 694, 13, 24, "Message"],
Cell[17438, 406, 713, 13, 42, "Message"],
Cell[18154, 421, 713, 13, 42, "Message"],
Cell[18870, 436, 712, 13, 42, "Message"],
Cell[19585, 451, 696, 13, 24, "Message"],
Cell[20284, 466, 1041, 18, 78, "Message"],
Cell[21328, 486, 1041, 18, 58, "Message"],
Cell[22372, 506, 1041, 18, 58, "Message"],
Cell[23416, 526, 693, 13, 24, "Message"]
}, Open  ]],
Cell[24124, 542, 92, 1, 28, "Input"]
}, Open  ]],
Cell[24231, 546, 113, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[24369, 551, 100, 1, 50, "Section"],
Cell[24472, 554, 1032, 27, 182, "Input"],
Cell[CellGroupData[{
Cell[25529, 585, 1609, 40, 80, "Input"],
Cell[27141, 627, 1406, 39, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28584, 671, 101, 1, 28, "Input"],
Cell[28688, 674, 1864, 42, 114, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30589, 721, 75, 1, 28, "Input"],
Cell[30667, 724, 1838, 41, 114, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32542, 770, 130, 2, 28, "Input"],
Cell[32675, 774, 582, 17, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33294, 796, 216, 4, 28, "Input"],
Cell[33513, 802, 1073, 22, 190, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34623, 829, 133, 2, 28, "Input"],
Cell[34759, 833, 204, 3, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35000, 841, 267, 5, 28, "Input"],
Cell[35270, 848, 1077, 22, 190, "Output"]
}, Open  ]],
Cell[36362, 873, 886, 21, 131, "Input"],
Cell[CellGroupData[{
Cell[37273, 898, 2346, 59, 199, "Input"],
Cell[39622, 959, 4169, 107, 182, "Output"]
}, Open  ]],
Cell[43806, 1069, 138, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[43969, 1074, 349, 7, 28, "Input"],
Cell[44321, 1083, 3613, 86, 265, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47971, 1174, 284, 5, 46, "Input"],
Cell[CellGroupData[{
Cell[48280, 1183, 329, 5, 22, "Print"],
Cell[48612, 1190, 388, 6, 22, "Print"],
Cell[49003, 1198, 321, 5, 22, "Print"],
Cell[49327, 1205, 321, 5, 22, "Print"],
Cell[49651, 1212, 334, 5, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[50034, 1223, 558, 12, 46, "Input"],
Cell[50595, 1237, 2840, 78, 189, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53484, 1321, 150, 2, 64, "Section"],
Cell[CellGroupData[{
Cell[53659, 1327, 1539, 37, 199, "Input"],
Cell[55201, 1366, 3115, 84, 114, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58353, 1455, 118, 2, 28, "Input"],
Cell[CellGroupData[{
Cell[58496, 1461, 226, 4, 43, "Print",
 CellTags->"Info-40948772-cfc9-4368-9d68-33757ef5873a"],
Cell[58725, 1467, 4483, 116, 269, "Print",
 CellTags->"Info-40948772-cfc9-4368-9d68-33757ef5873a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[63257, 1589, 101, 1, 28, "Input"],
Cell[63361, 1592, 2532, 57, 165, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65930, 1654, 220, 5, 46, "Input"],
Cell[66153, 1661, 555, 15, 104, "Output"]
}, Open  ]],
Cell[66723, 1679, 886, 21, 131, "Input"],
Cell[CellGroupData[{
Cell[67634, 1704, 2346, 59, 199, "Input"],
Cell[69983, 1765, 1488, 40, 63, "Output"]
}, Open  ]],
Cell[71486, 1808, 138, 1, 30, "Text"],
Cell[71627, 1811, 1397, 39, 63, "Output"],
Cell[CellGroupData[{
Cell[73049, 1854, 349, 7, 28, "Input"],
Cell[73401, 1863, 538, 9, 35, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
